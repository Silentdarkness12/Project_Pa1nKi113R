Actor GotBloody : Inventory
{
inventory.maxamount 1
}

Actor TargetIsAnExplosiveBarrel : Inventory
{
inventory.maxamount 1
}

Actor HasExplosiveBarrel : Inventory
{
inventory.maxamount 1
}

Actor ComingTOGetTheBarrel : Inventory
{
inventory.maxamount 1
}
ACTOR ExplosiveBarrel1 Replaces ExplosiveBarrel
{
	Game Doom
    damagefactor "Trample", 0.0
    damagefactor "Trample", 0.1
    damagefactor "Kick", 0.1
	damagefactor "SuperKick", 0.01
    damagefactor "Melee", 0.1
	damagefactor "Fatality", 10.1
	damagefactor "SuperPunch", 10.1
	damagefactor "ExplosiveImpact", 0.4
	damagefactor "Extremepunches", 0.0
	damagefactor "Fire", 3.5
	damagefactor "Blood", 1.0    damagefactor "GreenBlood", 0.0    damagefactor "BlueBlood", 0.0    damagefactor "Taunt", 0.0    damagefactor "KillMe", 0.0  damagefactor "Avoid", 0.0  damagefactor "Taunt", 0.0 damagefactor "Head", 0.0 damagefactor "minorhead", 0.0
	DamageFactor "bloodsplasher", 1.0    DamageFactor "tinybloodsplasher", 1.0    DamageFactor "superbloodsplasher", 1.0    DamageFactor "smallbloodsplasher", 1.0
	DamageFactor "BlueBloodSplasher", 0.0
    DamageFactor "BlueSuperBloodSplasher", 0.0
	damagefactor "BHFTOnBarrel", 500.0
	SpawnID 125
	Health 20
	Radius 10
	Height 34
    Mass 200
	DamageType DontCallTheBaron
	+SOLID
	+SHOOTABLE
	+NOBLOOD
	+ACTIVATEMCROSS
	+NOICEDEATH
    +PUSHABLE
	+SLIDESONWALLS
    +WINDTHRUST
    +TELESTOMP
	+NOBLOCKMONST
	+FLOORCLIP
	+FRIENDLY
	+MISSILEMORE
	+MISSILEEVENMORE
	MONSTER
	-COUNTKILL
	Speed 0
	MaxTargetRange 200
	DamageFactor "BHFT", 10.0
	Painchance "Blood", 255
	Painchance "Bloodsplasher", 255
	Painchance "Superbloodsplasher", 255
	Painchance "Tinybloodsplasher", 255
	Painchance "SmallBloodSplasher", 255
	PainChance "Kick", 255
	PainChance "SuperKick", 255
	DeathSound "Explosion"
	Obituary "$OB_BARREL"
	PainChance "DontCallTheBaron", 255
	States
	{
	Spawn:
	    BAR1 A 1
		TNT1 A 0 A_GiveInventory("TargetIsANExplosiveBarrel", 1)
		TNT1 A 0 A_PlaySound("world/barrelloop",7,1,1)
		TNT1 A 0 A_JumpIfInventory("GotBloody", 1, "StayBloody")
		BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
		BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
		TNT1 A 0 A_Look
		Goto See
		Loop
		
	Spawn2:
	    BAR1 A 3
		Goto Spawn
	
	See:	
		TNT1 A 0 A_PlaySound("world/barrelloop",7,1,1)
		TNT1 A 0 A_JumpIfInventory("GotBloody", 1, "StayBloody")
	    BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
		BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
		BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
		BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
		TNT1 A 0 A_CheckSight("See2")
		TNT1 AAAAAAAAA 0 A_Chase
		Loop
	See2:	
		BAR1 AB 1 A_Chase
		Goto See
		
	Missile:
	TNT1 A 0
	TNT1 A 0 A_JumpIfInTargetInventory("TargetIsABaronOfHell", 1, "TauntTHeBaron")
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	Goto See
	
	TauntTheBaron:
	TNT1 A 0
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	TNT1 A 0 A_JumpIfCloser(210, 1)
	Goto See
	TNT1 A 0 A_JumpIfInTargetInventory("ComingToGetTheBarrel", 1, "DoingNothing")
	TNT1 A 0 A_GiveInventory("TargetIsANExplosiveBarrel", 1)
	TNT1 A 0 A_FaceTarget
	TNT1 A 0 A_CustomMissile("CallingTheBaronAFaggot", 36, 0, 0, 1)
	TNT1 A 0 A_GiveToTarget("ComingTOGetTheBarrel", 1)
	DoingNothing:
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
    BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
    BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
    BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	BAR1 A 4 A_SpawnItem("greenlensflarealtsmall",0,32)
    BAR1 B 4 A_SpawnItem("greenlensflarealtsmall",0,32)
	Goto See
	
		
	Pain.Blood:
	Pain.Bloodsplasher:
	Pain.Superbloodsplasher:
	Pain.Tinybloodsplasher:
	Pain.Trample:
	Pain.SmallBloodSplasher:
	    TNT1 A 0
		TNT1 A 0 HealThing(100)
	    TNT1 A 0 A_GiveInventory("GotBloody", 1)
	    Goto StayBloody
	StayBloody:
		TNT1 A 0 A_GiveInventory("TargetIsANExplosiveBarrel", 1)
	    TNT1 A 0 A_CheckSight("Spawn2")
		TNT1 A 0 A_PlaySound("world/barrelloop",7,1,1)
		BARB A 4  A_SpawnItem("greenlensflarealtsmall",0,32)
		TNT1 A 0 A_CheckSight("Spawn2")
		BARB A 4  A_SpawnItem("greenlensflarealtsmall",0,32)
		TNT1 A 0 A_CheckSight("Spawn2")
		BARB B 4  A_SpawnItem("greenlensflarealtsmall",0,32)
		TNT1 A 0 A_CheckSight("Spawn2")
		BARB B 4  A_SpawnItem("greenlensflarealtsmall",0,32)
		Loop		
		
   Pain.Kick:
   Pain.SuperKick:
		TNT1 A 0 HealThing(100)
		TNT1 A 0 A_Changeflag("FRIENDLY", 0)
	    BAR1 A 1 A_Pain
		BAR1 A 0 A_Chase("","")
        BAR1 A 1 A_FaceTarget
		TNT1 A 0 HealThing(100)
		TNT1 A 0 ThrustThing(angle*256/360+128, 10, 0, 0)
		TNT1 A 0 ThrustThingZ(0,20,0,1)
		TNT1 A 0 A_Changeflag("FRIENDLY", 1)
		TNT1 A 0 A_JumpIfInventory("GotBloody", 1, "StayBloody")
		
        Goto Spawn
	Pain.Melee:
	    TNT1 A 0 A_Changeflag("FRIENDLY", 0)
	    BAR1 A 1 A_Pain
		BAR1 A 0 A_Chase("","")
        BAR1 A 1 A_FaceTarget
		TNT1 A 0 HealThing(100)
		TNT1 A 0 ThrustThing(angle*256/360+128, 5, 0, 0)
		TNT1 A 0 ThrustThingZ(0,10,0,1)
		TNT1 A 0 A_Changeflag("FRIENDLY", 1)
		TNT1 A 0 A_JumpIfInventory("GotBloody", 1, "StayBloody")
        Goto Spawn	
		
	Death:
        BAR1 A 1 BRIGHT
        BEXP ABCD 2 BRIGHT
	    TNT1 A 0 A_NoBlocking
	    TNT1 A 0 A_Fall
		TNT1 A 0 A_SpawnItem ("BigRicoChet", 0, -15)
		TNT1 A 0 A_SpawnItemEx ("DetectFloorCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
	    TNT1 A 0 A_SpawnItemEx ("DetectCeilCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 0 A_SpawnItemEx ("ExplosionFlareSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
        TNT1 A 0 A_SpawnItemEx ("BarrelExplosion",0,0,30,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 A 0 A_SpawnItemEx ("BarrelKaboom",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
		TNT1 AAAAAAA 0 A_CustomMissile ("ExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360))
        TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, 180))
        TNT1 AAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 0, 0, random (0, 360), 2, random (0, 180))
	    EXPL A 0 Radius_Quake (2, 24, 0, 15, 0)
		BEXP B 0 BRIGHT A_Scream
        
		TNT1 AAA 0 A_CustomMissile ("BarrelShrapnel1", 25, 0, random (0, 360), 2, random (30, 160))
		TNT1 AAA 0 A_CustomMissile ("BarrelShrapnel2", 15, 0, random (0, 360), 2, random (30, 160))
		TNT1 AAA 0 A_CustomMissile ("BarrelShrapnel3", 5, 0, random (0, 360), 2, random (30, 160))
		TNT1 AAA 0 A_CustomMissile ("BarrelShrapnel4", 5, 0, random (0, 360), 2, random (30, 160))
		TNT1 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0 A_CustomMissile ("ShrapnelParticle2", 0, 0, random (0, 360), 2, random (5, 90))
		TNT1 A 0 A_PlaySound("FAREXPL", 3)
		TNT1 A 0 A_SpawnItem("BarrelExplosionSmokeColumn")
		TNT1 AAAAA 8 A_CustomMissile ("ExplosionSmoke", 1, 0, random (0, 360), 2, random (50, 130))

		BEXP Z 300 BRIGHT A_BarrelDestroy
		BEXP Z 5 A_Respawn
		Wait
		
	 Death.SuperPunch:	
	 Death.Fatality:
        TNT1 A 0 A_NoBlocking
		TNT1 A 0 A_GiveToTarget("GoSpecial", 1)
        TNT1 A 0 A_GiveToTarget("HasBarrel", 1)
        Stop
	Death.Massacre:
	TNT1 A 0 A_NoBlocking
	TNT1 A 1
	TNT1 A 0 A_SPawnItem("ExplosiveBarrel1")
	Stop
	
	Death.BHFT:
	Death.BHFTOnBarrel:
	TNT1 A 0
	TNT1 A 0 A_GiveToTarget("HasExplosiveBarrel", 1)
	TNT1 A 0 A_NoBlocking
	TNT1 A 0 A_FAll
	TNT1 A 1
	Stop
		
	}
}

actor GreatKaboom: DeadMarine
{
	Game Doom
	States
	{
Spawn:
TNT1 A 50
TNT1 AAAA 0 A_CustomMissile ("ExplosionSpawner", 20, 0, random (0, 360), 2, random (0, 180))
        TNT1 AAAAAA 0 A_CustomMissile ("ExplosionSpawner", 20, 0, random (0, 360), 2, random (0, 180))
Stop
	}
}

actor UltraKaboom: DeadMarine
{
	Game Doom
	States
	{
Spawn:
TNT1 A 50
TNT1 AAAA 0 A_CustomMissile ("LongExplosionSpawner", 20, 0, random (0, 360), 2, random (0, 180))
        TNT1 AAAAAA 0 A_CustomMissile ("ExplosionSpawner", 20, 0, random (0, 360), 2, random (0, 180))
Stop
	}
}

actor BarrelKaboom: DeadMarine
{
	Game Doom
	States
	{
Spawn:
TNT1 A 1
TNT1 AAAAAA 0 A_CustomMissile ("SmallExplosionSpawner", 20, 0, random (0, 360), 2, random (0, 180))
Stop
	}
}

Actor ExplosionSpawner
{
+MISSILE
+FORCEXYBILLBOARD
damage 35
radius 6
height 6
speed 40
renderstyle ADD
alpha 0.9
scale .01
SeeSound "Explosion"
BounceFactor 0.5
Decal "FireworxScorch"
states
	{
	Spawn:
		TNT1 AAAA 2 A_SpawnItem("SpawnedExplosion")
		Stop
Death:
    MISG A 1
	TNT1 A 0 A_SpawnItemEx ("DetectCeilCrater",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
    TNT1 A 10
    Stop
XDeath:
MISG A 1
TNT1 A 10
Stop
	}
}

Actor SmallExplosionSpawner: ExplosionSpawner
{
Speed 30
states
	{
	Spawn:
		TNT1 AAAA 2 A_SpawnItem("SpawnedExplosionSmall")
		Stop
	}
}

Actor LongExplosionSpawner: ExplosionSpawner
{
speed 66
renderstyle ADD
alpha 0.9
scale .15
Decal "BigScorch"
states
	{
	Spawn:
		TNT1 AAAAAA 2 A_SpawnItem("SpawnedExplosion")
		Stop
	}
}

Actor SpawnedExplosion
{
SeeSound "Explosion"
+NOCLIP
+NOGRAVITY
states
	{
	Spawn:
 TNT1 A 2
 TNT1 A 2 A_PlaySound("FAREXPL")
 EXPL A 0 A_CustomMissile ("BigNeoSmoke", 0, 0, random (0, 360), 2, random (0, 360))
 EXPL A 0 A_CustomMissile ("ExplosionSmoke", 0, 0, random (0, 360), 2, random (0, 360))
 TNT1 A 0 A_SpawnItemEx ("ExplosionFlareSpawner",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
TNT1 AAAA 0 A_CustomMissile ("ExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360))
		Stop
	}
}

Actor SpawnedFlamers
{
+NOCLIP
+NOGRAVITY
    DamageType Flames
states
	{
	Spawn:
 TNT1 A 2
TNT1 A 0 A_Explode(100,40)
TNT1 AAAA 0 A_CustomMissile ("ExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360))
		Stop
	}
}

Actor SpawnedExplosionSmall
{
SeeSound "Explosion"
+NOCLIP
+NOGRAVITY
states
	{
	Spawn:
 TNT1 A 2
 TNT1 A 2
 EXPL A 0 A_CustomMissile ("BigNeoSmoke", 0, 0, random (0, 360), 2, random (0, 360))
 EXPL A 0 A_CustomMissile ("ExplosionSmoke", 0, 0, random (0, 360), 2, random (0, 360))
 TNT1 AAAA 0 A_CustomMissile ("SmallExplosionFlames", 0, 0, random (0, 360), 2, random (0, 360))
		Stop
	}
}

ACTOR KarasawaMissile
{
	Radius 32
	Height 4
	Speed 50
	Damage 40
    DamageType Cut
	Decal "Scorch"
	Projectile
	+RANDOMIZE
	+RIPPER
renderstyle ADD
alpha 0.90
XScale 3.0
YScale 0.9
	DeathSound "weapons/plasmax"
    SeeSound "None"
	Obituary "$OB_MPPLASMARIFLE"
	States
	{
	Spawn:
         KWBB ABCD 2 BRIGHT A_SpawnItem("KarasawaTrails",0,0)
		Loop

Death:
	TNT1 AAAAAA 0 A_CustomMissile ("BluePlasmaFire", 0, 0, random (0, 360), 2, random (0, 360))
	TNT1 AAAAAAAAAAAAAAAAA 0 A_CustomMissile ("BluePlasmaParticle", 0, 0, random (0, 360), 2, random (0, 360))
	KWBD ABCDEF 2
	TNT2 AAAAAAAA 4 A_CustomMissile ("PlasmaSmoke", 1, 0, random (0, 360), 2, random (0, 160))
		Stop
	}
}

ACTOR KarasawaTrails
{
 game Doom
 radius 8
 height 1
 damage 0
 Renderstyle Add
 Alpha 0.95
 XScale 3.0
YScale 0.9
   +MISSILE
   +CLIENTSIDEONLY
   +NOTELEPORT
   +NOBLOCKMAP
   +CORPSE
   +BLOODLESSIMPACT 
   +FORCEXYBILLBOARD
   +NODAMAGETHRUST
   +MOVEWITHSECTOR
   +NOBLOCKMONST
   -SOLID
   +THRUACTORS
   -DONTSPLASH
   +NOGRAVITY
    States
    {
     Spawn:
	 KWBB ABCDABCDABCDABCD 2 BRIGHT A_FadeOut(0.2) 
     Stop
    }
}